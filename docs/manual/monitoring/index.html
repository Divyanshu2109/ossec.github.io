<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Log monitoring/analysis &#8212; OSSEC</title>
    
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/parallax.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '3.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Process Monitoring" href="process-monitoring.html" />
    <link rel="prev" title="Writing Agentless Scripts" href="../agent/agentless-scripts.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><img src="../../../_static/ossec_logo_bare_small.png">
          OSSEC</a>
        <span class="navbar-text navbar-version pull-left"><b>3.3</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../about.html">About <i class="fa fa-info-circle"></i></a></li>
                <li><a href="../../">Documentation <i class="fa fa-book"></i></a></li>
                <li><a href="../../../downloads.html">Downloads <i class="fa fa-download"></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cookbooks/index.html">User submitted Cookbooks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/build/index.html">Build, compile, and not much more</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/oRFC/index.html">oRFC:</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../syntax/index.html">Syntax and Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats/index.html">Output Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programs/index.html">Man pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../agent/agentless-scripts.html" title="Previous Chapter: Writing Agentless Scripts"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Writing Agent...</span>
    </a>
  </li>
  <li>
    <a href="process-monitoring.html" title="Next Chapter: Process Monitoring"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Process Monitoring &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="log-monitoring-analysis">
<span id="manual-analysis"></span><h1>Log monitoring/analysis<a class="headerlink" href="#log-monitoring-analysis" title="Permalink to this headline">¶</a></h1>
<p>Log Analysis (or log inspection) is done inside OSSEC by the logcollector and
analysisd processes. The first one collects the events and the second one
analyzes (decodes, filters and classifies) them.</p>
<p>It is done in real time, so as soon as an event is written OSSEC will process
them. OSSEC can read events from internal log files, from the Windows event
log and also receive them directly via remote syslog.</p>
<div class="section" id="what-is-log-analysis">
<h2>What is log analysis?<a class="headerlink" href="#what-is-log-analysis" title="Permalink to this headline">¶</a></h2>
<p>Inside OSSEC we call log analysis a LIDS, or log-based intrusion detection. The
goal is to detect attacks, misuse or system errors using the logs.</p>
<p>LIDS - Log-based intrusion detection or security log analysis are the processes
or techniques used to detect attacks on a specific network, system or application
using logs as the primary source of information. It is also very useful to detect
software misuse, policy violations and other forms of inappropriate activities.</p>
</div>
<div class="section" id="quick-facts">
<h2>Quick Facts<a class="headerlink" href="#quick-facts" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>How often are logs monitored?<ul>
<li>In real time.</li>
</ul>
</li>
<li>Where are the events analyzed?<ul>
<li>In the manager.</li>
</ul>
</li>
<li>How long are they stored?<ul>
<li>For as long as your policy dictates (it is user configurable).</li>
</ul>
</li>
<li>Where does this help me with compliance?<ul>
<li>(PCI DSS, etc) It helps with the whole section 10 (log monitoring) of PCI.</li>
</ul>
</li>
<li>How much CPU does it use?<ul>
<li>On the agent, it uses very little CPU/memory since it just read the events and forwards them to the manager.</li>
<li>On the manager, it depends on the number of events per second (EPS).</li>
</ul>
</li>
<li>How does it deal with false positives?<ul>
<li>False positives can be eliminated using local rules.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="configuration-options">
<h2>Configuration Options<a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h2>
<p>These options should be specified locally in each agent&#8217;s ossec.conf file or the
share agent.conf. Inside the <code class="docutils literal"><span class="pre">&lt;localfile&gt;</span></code> element, you can have the following
options.</p>
</div>
<div class="section" id="monitoring-logs">
<h2>Monitoring logs<a class="headerlink" href="#monitoring-logs" title="Permalink to this headline">¶</a></h2>
<p>With in OSSEC there are two major methods for monitoring logs: file and process.  Each
method has its own page and examples.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="process-monitoring.html">Process Monitoring</a><ul>
<li class="toctree-l2"><a class="reference internal" href="process-monitoring.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="process-monitoring.html#configuration-examples">Configuration examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="process-monitoring.html#disk-space-utilization-df-h-example">Disk space utilization (df -h) example</a></li>
<li class="toctree-l3"><a class="reference internal" href="process-monitoring.html#load-average-uptime-example">Load average (uptime) Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="process-monitoring.html#alerting-when-output-of-a-command-changes">Alerting when output of a command changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="process-monitoring.html#detecting-usb-storage-usage">Detecting USB Storage Usage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="file-log-monitoring.html">File Monitoring</a><ul>
<li class="toctree-l2"><a class="reference internal" href="file-log-monitoring.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="file-log-monitoring.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="file-log-monitoring.html#configuration-examples">Configuration examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="file-log-monitoring.html#simple-example">Simple example</a></li>
<li class="toctree-l3"><a class="reference internal" href="file-log-monitoring.html#windows-eventlog-example">Windows EventLog Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="file-log-monitoring.html#windows-eventchannel-example">Windows EventChannel Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="file-log-monitoring.html#multiple-files-example">Multiple Files Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="file-log-monitoring.html#date-based-example">Date Based Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="file-log-monitoring.html#iis-logs-example">IIS Logs Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2020, OSSEC Project Team.<br/>
    OSSEC <b>ossec.net</b> domain owned and maintained by <a href="https://www.ossec.net" target="_blank">OSSEC Foundation</a><br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.5.2 - 
    Home page graphics courtesy of <a href="https://pixabay.com" target="_blank">pixabay</a>
    </p>
  </div>
</footer>
  </body>
</html>